(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     75332,       2035]
NotebookOptionsPosition[     70366,       1948]
NotebookOutlinePosition[     70752,       1965]
CellTagsIndexPosition[     70709,       1962]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"M", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rx", ",", " ", "ux", ",", " ", "vx", ",", " ", "0"}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{"ry", ",", " ", "uy", ",", " ", "vy", ",", " ", "0"}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{"rz", ",", " ", "uz", ",", " ", "vz", ",", " ", "0"}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", "1"}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "0", ",", " ", "0", ",", " ", "tx"}], "}"}], ",",
      " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "1", ",", " ", "0", ",", " ", "ty"}], "}"}], ",",
      " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "1", ",", " ", "tz"}], "}"}], ",",
      " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", "1"}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MInv", " ", "=", " ", 
  RowBox[{
   RowBox[{"Inverse", "[", "T", "]"}], "//", "MatrixForm"}]}]}], "Input",
 CellChangeTimes->{{3.8962590245930634`*^9, 3.8962591521252623`*^9}, {
  3.8962592264381495`*^9, 3.8962592369326653`*^9}, {3.896259795180151*^9, 
  3.8962598509072375`*^9}, {3.8962600248520527`*^9, 3.896260091172021*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"500b4d60-3c61-493a-8add-e35571207041"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", 
      RowBox[{"-", "tx"}]},
     {"0", "1", "0", 
      RowBox[{"-", "ty"}]},
     {"0", "0", "1", 
      RowBox[{"-", "tz"}]},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.896259837194654*^9, 3.8962598519768314`*^9}, 
   3.8962600944335747`*^9},
 CellLabel->
  "Out[15]//MatrixForm=",ExpressionUUID->"582ce7c3-0129-4f61-a9e2-\
c5b49489e218"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Comp", " ", "=", " ", 
  RowBox[{
   RowBox[{"M", " ", ".", "T"}], "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.896259240857317*^9, 3.896259242066792*^9}, {
  3.896260105760607*^9, 3.8962601534109974`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"9bde7ba8-935a-42d7-93cc-b8507fcff598"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"rx", "ux", "vx", 
      RowBox[{
       RowBox[{"rx", " ", "tx"}], "+", 
       RowBox[{"ty", " ", "ux"}], "+", 
       RowBox[{"tz", " ", "vx"}]}]},
     {"ry", "uy", "vy", 
      RowBox[{
       RowBox[{"ry", " ", "tx"}], "+", 
       RowBox[{"ty", " ", "uy"}], "+", 
       RowBox[{"tz", " ", "vy"}]}]},
     {"rz", "uz", "vz", 
      RowBox[{
       RowBox[{"rz", " ", "tx"}], "+", 
       RowBox[{"ty", " ", "uz"}], "+", 
       RowBox[{"tz", " ", "vz"}]}]},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.896260124880565*^9, 3.896260156526164*^9}},
 CellLabel->
  "Out[19]//MatrixForm=",ExpressionUUID->"8f8dc3e6-c23b-453f-9da7-\
83f844b6465d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Inverse", "[", "M", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.896260157312257*^9, 3.896260248555805*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"3af15df1-59ac-4b71-bb66-e1f450f3ec4d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "uz"}], " ", "vy"}], "+", 
        RowBox[{"uy", " ", "vz"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "rz"}], " ", "uy", " ", "vx"}], "+", 
        RowBox[{"ry", " ", "uz", " ", "vx"}], "+", 
        RowBox[{"rz", " ", "ux", " ", "vy"}], "-", 
        RowBox[{"rx", " ", "uz", " ", "vy"}], "-", 
        RowBox[{"ry", " ", "ux", " ", "vz"}], "+", 
        RowBox[{"rx", " ", "uy", " ", "vz"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"uz", " ", "vx"}], "-", 
        RowBox[{"ux", " ", "vz"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "rz"}], " ", "uy", " ", "vx"}], "+", 
        RowBox[{"ry", " ", "uz", " ", "vx"}], "+", 
        RowBox[{"rz", " ", "ux", " ", "vy"}], "-", 
        RowBox[{"rx", " ", "uz", " ", "vy"}], "-", 
        RowBox[{"ry", " ", "ux", " ", "vz"}], "+", 
        RowBox[{"rx", " ", "uy", " ", "vz"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "uy"}], " ", "vx"}], "+", 
        RowBox[{"ux", " ", "vy"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "rz"}], " ", "uy", " ", "vx"}], "+", 
        RowBox[{"ry", " ", "uz", " ", "vx"}], "+", 
        RowBox[{"rz", " ", "ux", " ", "vy"}], "-", 
        RowBox[{"rx", " ", "uz", " ", "vy"}], "-", 
        RowBox[{"ry", " ", "ux", " ", "vz"}], "+", 
        RowBox[{"rx", " ", "uy", " ", "vz"}]}]], "0"},
     {
      FractionBox[
       RowBox[{
        RowBox[{"rz", " ", "vy"}], "-", 
        RowBox[{"ry", " ", "vz"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "rz"}], " ", "uy", " ", "vx"}], "+", 
        RowBox[{"ry", " ", "uz", " ", "vx"}], "+", 
        RowBox[{"rz", " ", "ux", " ", "vy"}], "-", 
        RowBox[{"rx", " ", "uz", " ", "vy"}], "-", 
        RowBox[{"ry", " ", "ux", " ", "vz"}], "+", 
        RowBox[{"rx", " ", "uy", " ", "vz"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "rz"}], " ", "vx"}], "+", 
        RowBox[{"rx", " ", "vz"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "rz"}], " ", "uy", " ", "vx"}], "+", 
        RowBox[{"ry", " ", "uz", " ", "vx"}], "+", 
        RowBox[{"rz", " ", "ux", " ", "vy"}], "-", 
        RowBox[{"rx", " ", "uz", " ", "vy"}], "-", 
        RowBox[{"ry", " ", "ux", " ", "vz"}], "+", 
        RowBox[{"rx", " ", "uy", " ", "vz"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"ry", " ", "vx"}], "-", 
        RowBox[{"rx", " ", "vy"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "rz"}], " ", "uy", " ", "vx"}], "+", 
        RowBox[{"ry", " ", "uz", " ", "vx"}], "+", 
        RowBox[{"rz", " ", "ux", " ", "vy"}], "-", 
        RowBox[{"rx", " ", "uz", " ", "vy"}], "-", 
        RowBox[{"ry", " ", "ux", " ", "vz"}], "+", 
        RowBox[{"rx", " ", "uy", " ", "vz"}]}]], "0"},
     {
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "rz"}], " ", "uy"}], "+", 
        RowBox[{"ry", " ", "uz"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "rz"}], " ", "uy", " ", "vx"}], "+", 
        RowBox[{"ry", " ", "uz", " ", "vx"}], "+", 
        RowBox[{"rz", " ", "ux", " ", "vy"}], "-", 
        RowBox[{"rx", " ", "uz", " ", "vy"}], "-", 
        RowBox[{"ry", " ", "ux", " ", "vz"}], "+", 
        RowBox[{"rx", " ", "uy", " ", "vz"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"rz", " ", "ux"}], "-", 
        RowBox[{"rx", " ", "uz"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "rz"}], " ", "uy", " ", "vx"}], "+", 
        RowBox[{"ry", " ", "uz", " ", "vx"}], "+", 
        RowBox[{"rz", " ", "ux", " ", "vy"}], "-", 
        RowBox[{"rx", " ", "uz", " ", "vy"}], "-", 
        RowBox[{"ry", " ", "ux", " ", "vz"}], "+", 
        RowBox[{"rx", " ", "uy", " ", "vz"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "ry"}], " ", "ux"}], "+", 
        RowBox[{"rx", " ", "uy"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "rz"}], " ", "uy", " ", "vx"}], "+", 
        RowBox[{"ry", " ", "uz", " ", "vx"}], "+", 
        RowBox[{"rz", " ", "ux", " ", "vy"}], "-", 
        RowBox[{"rx", " ", "uz", " ", "vy"}], "-", 
        RowBox[{"ry", " ", "ux", " ", "vz"}], "+", 
        RowBox[{"rx", " ", "uy", " ", "vz"}]}]], "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8962602387899075`*^9, 3.89626024901198*^9}},
 CellLabel->
  "Out[27]//MatrixForm=",ExpressionUUID->"b6ea8598-8494-4b40-bc37-\
1df0739e51a4"]
}, Open  ]],

Cell["arbitrary rotation matrix", "Item",
 CellChangeTimes->{{3.896245332062425*^9, 
  3.8962453988006983`*^9}},ExpressionUUID->"a171dad5-5b52-4fb0-aff9-\
56ed50bfb95f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"v", " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{"vx", ",", " ", "vy", ",", " ", "vz"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{"ax", ",", " ", "ay", ",", " ", "az"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.896228244897756*^9, 3.896228275927318*^9}, {
  3.896228334327982*^9, 3.8962284047589436`*^9}, {3.8962285440007687`*^9, 
  3.896228555223624*^9}, {3.8962285899439473`*^9, 3.8962286018481693`*^9}, {
  3.8962453248344817`*^9, 
  3.8962453284161673`*^9}},ExpressionUUID->"9eb72d7a-445e-495f-9e08-\
fa10cea388e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vc", " ", "=", 
   RowBox[{"a", " ", 
    RowBox[{"Dot", "[", 
     RowBox[{"v", ",", " ", "a"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.896228410285157*^9, 3.8962284738882866`*^9}, 
   3.896228565323989*^9, 3.8962286280492163`*^9, 3.896228892240779*^9},
 CellLabel->"In[20]:=",ExpressionUUID->"4ffd4c0f-1428-4124-95d8-3454b2df4212"],

Cell[BoxData[
 RowBox[{
  RowBox[{"v1", " ", "=", 
   RowBox[{"v", " ", "-", " ", "vc"}]}], " ", ";"}]], "Input",
 CellChangeTimes->{{3.8962286114969044`*^9, 3.896228640591654*^9}, 
   3.896228894648903*^9},
 CellLabel->"In[21]:=",ExpressionUUID->"96cb7322-7544-4bb3-ad58-73e0c8b7c7ab"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"v2", " ", "=", " ", 
  RowBox[{"Cross", "[", 
   RowBox[{"v1", ",", " ", "a"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8962286456164775`*^9, 3.896228656632164*^9}, 
   3.896228896727951*^9, {3.896232137749775*^9, 3.8962321382687073`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"3187cc61-e354-41c6-a8bd-ef2077b6f6ff"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"az", " ", "vy"}], "-", 
    RowBox[{"ay", " ", "vz"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "az"}], " ", "vx"}], "+", 
    RowBox[{"ax", " ", "vz"}]}], ",", 
   RowBox[{
    RowBox[{"ay", " ", "vx"}], "-", 
    RowBox[{"ax", " ", "vy"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.896232138785044*^9},
 CellLabel->"Out[75]=",ExpressionUUID->"40ed33fa-06f9-491d-879d-a8094f746a0e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"v", "'"}], " ", "=", " ", 
   RowBox[{"vc", " ", "+", " ", 
    RowBox[{"v1", " ", 
     RowBox[{"Cos", "[", "theta", "]"}]}], " ", "+", " ", 
    RowBox[{"v2", " ", 
     RowBox[{"Sin", "[", "theta", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.896228721043992*^9, 3.8962287581278715`*^9}, 
   3.8962288991529274`*^9, 3.896228940210003*^9, {3.896229689664566*^9, 
   3.8962296942247868`*^9}, {3.8962338418368607`*^9, 
   3.8962338437323995`*^9}, {3.896234472530853*^9, 3.89623448213068*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"f5ab1201-ae2a-45f5-badc-23f86f96ef1a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vvx", " ", "=", " ", 
   RowBox[{
    RowBox[{"v", "'"}], " ", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vx", "\[Rule]", "1"}], ",", " ", 
      RowBox[{"vy", "\[Rule]", "0"}], ",", " ", 
      RowBox[{"vz", "\[Rule]", "0"}], ",", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "theta", "]"}], "\[Rule]", "sin"}], ",", " ", 
      RowBox[{
       RowBox[{"Cos", "[", "theta", "]"}], "\[Rule]", "cos"}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8962287642562585`*^9, 3.896228869751749*^9}, {
   3.8962289167603626`*^9, 3.8962289200639544`*^9}, 3.896233859861288*^9, {
   3.896234468779808*^9, 3.8962344843225846`*^9}, {3.89623453142089*^9, 
   3.89623453915499*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"3179ea4c-9bb3-4dfb-adf9-5c6df0afe4b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vvy", " ", "=", " ", 
   RowBox[{
    RowBox[{"v", "'"}], " ", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vx", "\[Rule]", "0"}], ",", " ", 
      RowBox[{"vy", "\[Rule]", "1"}], ",", " ", 
      RowBox[{"vz", "\[Rule]", "0"}], ",", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "theta", "]"}], "\[Rule]", "sin"}], ",", " ", 
      RowBox[{
       RowBox[{"Cos", "[", "theta", "]"}], "\[Rule]", "cos"}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8962289113705316`*^9, 3.8962289368233566`*^9}, 
   3.8962338647094917`*^9, {3.896234466123488*^9, 3.896234486691025*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"c1cf67bf-211a-47ac-a3eb-b53f46859a92"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vvz", " ", "=", " ", 
   RowBox[{
    RowBox[{"v", "'"}], " ", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vx", "\[Rule]", "0"}], ",", " ", 
      RowBox[{"vy", "\[Rule]", "0"}], ",", " ", 
      RowBox[{"vz", "\[Rule]", "1"}], ",", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "theta", "]"}], "\[Rule]", "sin"}], ",", " ", 
      RowBox[{
       RowBox[{"Cos", "[", "theta", "]"}], "\[Rule]", "cos"}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.896228922175589*^9, 3.896228954903499*^9}, {
   3.896229031553532*^9, 3.896229032969283*^9}, 3.896233875813283*^9, {
   3.896234463459633*^9, 3.896234464282222*^9}, 3.8962344951787405`*^9},
 CellLabel->
  "In[114]:=",ExpressionUUID->"005be437-3579-4650-8ddd-a25fb451cf21"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vvx", ",", " ", "vvy", ",", " ", "vvz"}], "}"}], ",", " ", 
    RowBox[{"{", "2", "}"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8962290344207735`*^9, 3.8962290720955286`*^9}, {
   3.8962291049516687`*^9, 3.896229216167473*^9}, {3.896229347082224*^9, 
   3.896229356575869*^9}, {3.896229388344331*^9, 3.8962293953832197`*^9}, {
   3.8962294381044407`*^9, 3.896229453343566*^9}, 3.8962294851274166`*^9, {
   3.8962295564801517`*^9, 3.896229557375514*^9}, {3.896229598832035*^9, 
   3.8962296470787644`*^9}, {3.8962297112162876`*^9, 3.896229804832431*^9}, {
   3.8962298525064883`*^9, 3.896229861270111*^9}, {3.8962317417662535`*^9, 
   3.8962317663351097`*^9}, {3.8962334324419813`*^9, 
   3.8962334667086377`*^9}, {3.8962336950362363`*^9, 
   3.8962338108613915`*^9}, {3.896233884116249*^9, 3.896233963403673*^9}, {
   3.8962340605491514`*^9, 3.896234127371168*^9}, {3.8962341656591277`*^9, 
   3.896234174938714*^9}, {3.8962342119563074`*^9, 3.896234271667425*^9}, {
   3.8962343192272024`*^9, 3.896234338170212*^9}, {3.896234501899548*^9, 
   3.896234510810927*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"6e395f7f-a1aa-4e8f-b3bc-13ddd4c0a46f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SuperscriptBox["ax", "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["ax", "2"]}], ")"}], " ", "cos"}]}], 
      RowBox[{
       RowBox[{"ax", " ", "ay"}], "-", 
       RowBox[{"ax", " ", "ay", " ", "cos"}], "+", 
       RowBox[{"az", " ", "sin"}]}], 
      RowBox[{
       RowBox[{"ax", " ", "az"}], "-", 
       RowBox[{"ax", " ", "az", " ", "cos"}], "-", 
       RowBox[{"ay", " ", "sin"}]}]},
     {
      RowBox[{
       RowBox[{"ax", " ", "ay"}], "-", 
       RowBox[{"ax", " ", "ay", " ", "cos"}], "-", 
       RowBox[{"az", " ", "sin"}]}], 
      RowBox[{
       SuperscriptBox["ay", "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["ay", "2"]}], ")"}], " ", "cos"}]}], 
      RowBox[{
       RowBox[{"ay", " ", "az"}], "-", 
       RowBox[{"ay", " ", "az", " ", "cos"}], "+", 
       RowBox[{"ax", " ", "sin"}]}]},
     {
      RowBox[{
       RowBox[{"ax", " ", "az"}], "-", 
       RowBox[{"ax", " ", "az", " ", "cos"}], "+", 
       RowBox[{"ay", " ", "sin"}]}], 
      RowBox[{
       RowBox[{"ay", " ", "az"}], "-", 
       RowBox[{"ay", " ", "az", " ", "cos"}], "-", 
       RowBox[{"ax", " ", "sin"}]}], 
      RowBox[{
       SuperscriptBox["az", "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["az", "2"]}], ")"}], " ", "cos"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8962337245378094`*^9, {3.896233758315558*^9, 3.8962338118506913`*^9}, {
   3.8962338861337414`*^9, 3.896233963892389*^9}, 3.8962341758711185`*^9, {
   3.896234217537303*^9, 3.8962342721442933`*^9}, 3.896234339146387*^9, {
   3.8962344981189976`*^9, 3.8962345113290234`*^9}},
 CellLabel->
  "Out[116]//MatrixForm=",ExpressionUUID->"42910cfe-194e-4385-a741-\
d45590df5a5d"]
}, Open  ]],

Cell["\<\
 note : axis transform matrix just like above matrix, but if we rotate a \
point, the rotation direction is opposed to axis rotation direction, which \
will make sin term be opposite.\
\>", "Item",
 CellChangeTimes->{{3.8962293910316334`*^9, 3.8962293920783186`*^9}, 
   3.8962299884145565`*^9, {3.8962347435782814`*^9, 3.8962347451613393`*^9}, {
   3.8962353210503864`*^9, 3.8962353324099092`*^9}, {3.89623538125154*^9, 
   3.896235391992507*^9}, {3.8962354234412794`*^9, 3.8962355823302093`*^9}, {
   3.896245310286035*^9, 3.896245310287033*^9}, {3.896245491442399*^9, 
   3.8962454914433928`*^9}},ExpressionUUID->"2190c82c-85e2-4d56-b643-\
98981319ee91"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{{3.8962453183417854`*^9, 3.896245319424431*^9}, {
  3.896245407168045*^9, 
  3.896245500385498*^9}},ExpressionUUID->"b635e2f6-ebc6-4e8d-b6b0-\
f8e81c9dc52b"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.8962454835185857`*^9},ExpressionUUID->"3c756986-6164-4927-a5fa-\
9470b3b10776"],

Cell["quaternion computation", "Item",
 CellChangeTimes->{{3.8962293910316334`*^9, 3.8962293920783186`*^9}, 
   3.8962299884145565`*^9, {3.8962347435782814`*^9, 3.8962347451613393`*^9}, {
   3.8962353210503864`*^9, 3.8962353324099092`*^9}, {3.89623538125154*^9, 
   3.896235391992507*^9}, {3.8962354234412794`*^9, 3.8962355823302093`*^9}, {
   3.896245310286035*^9, 3.896245310287033*^9}, 3.8962454982990494`*^9, {
   3.8962455458253274`*^9, 
   3.896245560978695*^9}},ExpressionUUID->"fcea923a-c8c1-4d66-b5d4-\
607843cdb9ff"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"q", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"qx", ",", " ", "qy", ",", " ", "qz"}], "}"}], ",", " ", 
     RowBox[{"{", "qw", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"px", ",", " ", "py", ",", " ", "pz"}], "}"}], ",", " ", 
     RowBox[{"{", "pw", "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8962455658617268`*^9, 3.8962455862710624`*^9}, {
   3.896245617823745*^9, 3.896245727720025*^9}, {3.8962458467922187`*^9, 
   3.896245868633213*^9}, {3.896245940575796*^9, 3.8962459963207035`*^9}, 
   3.8963103771190596`*^9},ExpressionUUID->"a940db92-8077-4575-947c-\
ef760282914e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"m", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"q", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
        RowBox[{"p", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " ", "+", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"q", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], 
       RowBox[{"p", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], " ", "+", " ", 
      RowBox[{
       RowBox[{"q", "[", 
        RowBox[{"[", "1", "]"}], "]"}], 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"q", "[", 
        RowBox[{"[", "2", "]"}], "]"}], 
       RowBox[{"p", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], " ", "-", " ", 
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"q", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
        RowBox[{"p", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8962457026547256`*^9, 3.8962457138726597`*^9}, {
  3.896245886687719*^9, 3.8962458907451487`*^9}, {3.896246007169025*^9, 
  3.8962460349033403`*^9}, {3.896246067512409*^9, 3.8962460773277693`*^9}, {
  3.896246118992692*^9, 3.8962462246157165`*^9}, {3.896246480513104*^9, 
  3.8962465184727097`*^9}, {3.8962465768080387`*^9, 3.8962466275687537`*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"825ffb8d-f1ba-4ef2-b29f-845f5ae84f68"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"q", "'"}], " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"q", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
    RowBox[{"q", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"qn", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Cross", "[", 
      RowBox[{
       RowBox[{"q", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{"q", "'"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"q", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], 
      RowBox[{
       RowBox[{"q", "'"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{"q", "[", 
       RowBox[{"[", "1", "]"}], "]"}], 
      RowBox[{
       RowBox[{
        RowBox[{"q", "'"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"q", "[", 
       RowBox[{"[", "2", "]"}], "]"}], 
      RowBox[{
       RowBox[{"q", "'"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], " ", "-", " ", 
     RowBox[{"Dot", "[", 
      RowBox[{
       RowBox[{"q", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{"q", "'"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.8962467113372283`*^9, 3.8962468403599043`*^9}, 
   3.8962483673684063`*^9},
 CellLabel->
  "In[123]:=",ExpressionUUID->"f1442002-246a-4fa0-9ec6-d30b0158a241"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "qx"}], ",", 
     RowBox[{"-", "qy"}], ",", 
     RowBox[{"-", "qz"}]}], "}"}], ",", 
   RowBox[{"{", "qw", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.896246750159769*^9, 3.8962468414789643`*^9, 3.8962481955398507`*^9, 
   3.896248317215499*^9, {3.8962483639774723`*^9, 3.896248368160428*^9}, 
   3.896313637113581*^9},
 CellLabel->
  "Out[123]=",ExpressionUUID->"61010af5-6b97-4786-9721-fc0792977f4e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["qw", "2"], "+", 
     SuperscriptBox["qx", "2"], "+", 
     SuperscriptBox["qy", "2"], "+", 
     SuperscriptBox["qz", "2"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.896246750159769*^9, 3.8962468414789643`*^9, 3.8962481955398507`*^9, 
   3.896248317215499*^9, {3.8962483639774723`*^9, 3.896248368160428*^9}, 
   3.896313637115576*^9},
 CellLabel->
  "Out[124]=",ExpressionUUID->"6cb23ba7-c339-4fb3-aa62-984d19f3de98"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"qInv", " ", "=", " ", 
   RowBox[{
    RowBox[{"q", "'"}], " ", "/", " ", 
    RowBox[{
     RowBox[{"qn", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{"f", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Cross", "[", 
      RowBox[{
       RowBox[{"m", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{"qInv", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"m", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], 
      RowBox[{"qInv", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{"m", "[", 
       RowBox[{"[", "1", "]"}], "]"}], 
      RowBox[{
       RowBox[{"qInv", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"m", "[", 
       RowBox[{"[", "2", "]"}], "]"}], 
      RowBox[{"qInv", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], " ", "-", " ", 
     RowBox[{"Dot", "[", 
      RowBox[{
       RowBox[{"m", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{"qInv", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.8962468726198354`*^9, 3.8962469764248147`*^9}, {
   3.896247673919382*^9, 3.8962476834629383`*^9}, {3.896248109344026*^9, 
   3.896248110991012*^9}, 3.896248160182602*^9, {3.8962484749757915`*^9, 
   3.8962484885418463`*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"a795cf5f-5c09-48f1-9598-f0acee7276f5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"pz", " ", "qw", " ", "qy"}], 
       RowBox[{
        SuperscriptBox["qw", "2"], "+", 
        SuperscriptBox["qx", "2"], "+", 
        SuperscriptBox["qy", "2"], "+", 
        SuperscriptBox["qz", "2"]}]], "+", 
      FractionBox[
       RowBox[{"py", " ", "qx", " ", "qy"}], 
       RowBox[{
        SuperscriptBox["qw", "2"], "+", 
        SuperscriptBox["qx", "2"], "+", 
        SuperscriptBox["qy", "2"], "+", 
        SuperscriptBox["qz", "2"]}]], "-", 
      FractionBox[
       RowBox[{"px", " ", 
        SuperscriptBox["qy", "2"]}], 
       RowBox[{
        SuperscriptBox["qw", "2"], "+", 
        SuperscriptBox["qx", "2"], "+", 
        SuperscriptBox["qy", "2"], "+", 
        SuperscriptBox["qz", "2"]}]], "-", 
      FractionBox[
       RowBox[{"py", " ", "qw", " ", "qz"}], 
       RowBox[{
        SuperscriptBox["qw", "2"], "+", 
        SuperscriptBox["qx", "2"], "+", 
        SuperscriptBox["qy", "2"], "+", 
        SuperscriptBox["qz", "2"]}]], "+", 
      FractionBox[
       RowBox[{"pz", " ", "qx", " ", "qz"}], 
       RowBox[{
        SuperscriptBox["qw", "2"], "+", 
        SuperscriptBox["qx", "2"], "+", 
        SuperscriptBox["qy", "2"], "+", 
        SuperscriptBox["qz", "2"]}]], "-", 
      FractionBox[
       RowBox[{"px", " ", 
        SuperscriptBox["qz", "2"]}], 
       RowBox[{
        SuperscriptBox["qw", "2"], "+", 
        SuperscriptBox["qx", "2"], "+", 
        SuperscriptBox["qy", "2"], "+", 
        SuperscriptBox["qz", "2"]}]], "+", 
      FractionBox[
       RowBox[{"qw", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"px", " ", "qw"}], "+", 
          RowBox[{"pw", " ", "qx"}], "+", 
          RowBox[{"pz", " ", "qy"}], "-", 
          RowBox[{"py", " ", "qz"}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["qw", "2"], "+", 
        SuperscriptBox["qx", "2"], "+", 
        SuperscriptBox["qy", "2"], "+", 
        SuperscriptBox["qz", "2"]}]], "-", 
      FractionBox[
       RowBox[{"qx", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pw", " ", "qw"}], "-", 
          RowBox[{"px", " ", "qx"}], "-", 
          RowBox[{"py", " ", "qy"}], "-", 
          RowBox[{"pz", " ", "qz"}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["qw", "2"], "+", 
        SuperscriptBox["qx", "2"], "+", 
        SuperscriptBox["qy", "2"], "+", 
        SuperscriptBox["qz", "2"]}]]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"pz", " ", "qw", " ", "qx"}], 
        RowBox[{
         SuperscriptBox["qw", "2"], "+", 
         SuperscriptBox["qx", "2"], "+", 
         SuperscriptBox["qy", "2"], "+", 
         SuperscriptBox["qz", "2"]}]]}], "-", 
      FractionBox[
       RowBox[{"py", " ", 
        SuperscriptBox["qx", "2"]}], 
       RowBox[{
        SuperscriptBox["qw", "2"], "+", 
        SuperscriptBox["qx", "2"], "+", 
        SuperscriptBox["qy", "2"], "+", 
        SuperscriptBox["qz", "2"]}]], "+", 
      FractionBox[
       RowBox[{"px", " ", "qx", " ", "qy"}], 
       RowBox[{
        SuperscriptBox["qw", "2"], "+", 
        SuperscriptBox["qx", "2"], "+", 
        SuperscriptBox["qy", "2"], "+", 
        SuperscriptBox["qz", "2"]}]], "+", 
      FractionBox[
       RowBox[{"px", " ", "qw", " ", "qz"}], 
       RowBox[{
        SuperscriptBox["qw", "2"], "+", 
        SuperscriptBox["qx", "2"], "+", 
        SuperscriptBox["qy", "2"], "+", 
        SuperscriptBox["qz", "2"]}]], "+", 
      FractionBox[
       RowBox[{"pz", " ", "qy", " ", "qz"}], 
       RowBox[{
        SuperscriptBox["qw", "2"], "+", 
        SuperscriptBox["qx", "2"], "+", 
        SuperscriptBox["qy", "2"], "+", 
        SuperscriptBox["qz", "2"]}]], "-", 
      FractionBox[
       RowBox[{"py", " ", 
        SuperscriptBox["qz", "2"]}], 
       RowBox[{
        SuperscriptBox["qw", "2"], "+", 
        SuperscriptBox["qx", "2"], "+", 
        SuperscriptBox["qy", "2"], "+", 
        SuperscriptBox["qz", "2"]}]], "+", 
      FractionBox[
       RowBox[{"qw", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"py", " ", "qw"}], "-", 
          RowBox[{"pz", " ", "qx"}], "+", 
          RowBox[{"pw", " ", "qy"}], "+", 
          RowBox[{"px", " ", "qz"}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["qw", "2"], "+", 
        SuperscriptBox["qx", "2"], "+", 
        SuperscriptBox["qy", "2"], "+", 
        SuperscriptBox["qz", "2"]}]], "-", 
      FractionBox[
       RowBox[{"qy", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pw", " ", "qw"}], "-", 
          RowBox[{"px", " ", "qx"}], "-", 
          RowBox[{"py", " ", "qy"}], "-", 
          RowBox[{"pz", " ", "qz"}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["qw", "2"], "+", 
        SuperscriptBox["qx", "2"], "+", 
        SuperscriptBox["qy", "2"], "+", 
        SuperscriptBox["qz", "2"]}]]}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{"py", " ", "qw", " ", "qx"}], 
       RowBox[{
        SuperscriptBox["qw", "2"], "+", 
        SuperscriptBox["qx", "2"], "+", 
        SuperscriptBox["qy", "2"], "+", 
        SuperscriptBox["qz", "2"]}]], "-", 
      FractionBox[
       RowBox[{"pz", " ", 
        SuperscriptBox["qx", "2"]}], 
       RowBox[{
        SuperscriptBox["qw", "2"], "+", 
        SuperscriptBox["qx", "2"], "+", 
        SuperscriptBox["qy", "2"], "+", 
        SuperscriptBox["qz", "2"]}]], "-", 
      FractionBox[
       RowBox[{"px", " ", "qw", " ", "qy"}], 
       RowBox[{
        SuperscriptBox["qw", "2"], "+", 
        SuperscriptBox["qx", "2"], "+", 
        SuperscriptBox["qy", "2"], "+", 
        SuperscriptBox["qz", "2"]}]], "-", 
      FractionBox[
       RowBox[{"pz", " ", 
        SuperscriptBox["qy", "2"]}], 
       RowBox[{
        SuperscriptBox["qw", "2"], "+", 
        SuperscriptBox["qx", "2"], "+", 
        SuperscriptBox["qy", "2"], "+", 
        SuperscriptBox["qz", "2"]}]], "+", 
      FractionBox[
       RowBox[{"px", " ", "qx", " ", "qz"}], 
       RowBox[{
        SuperscriptBox["qw", "2"], "+", 
        SuperscriptBox["qx", "2"], "+", 
        SuperscriptBox["qy", "2"], "+", 
        SuperscriptBox["qz", "2"]}]], "+", 
      FractionBox[
       RowBox[{"py", " ", "qy", " ", "qz"}], 
       RowBox[{
        SuperscriptBox["qw", "2"], "+", 
        SuperscriptBox["qx", "2"], "+", 
        SuperscriptBox["qy", "2"], "+", 
        SuperscriptBox["qz", "2"]}]], "+", 
      FractionBox[
       RowBox[{"qw", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pz", " ", "qw"}], "+", 
          RowBox[{"py", " ", "qx"}], "-", 
          RowBox[{"px", " ", "qy"}], "+", 
          RowBox[{"pw", " ", "qz"}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["qw", "2"], "+", 
        SuperscriptBox["qx", "2"], "+", 
        SuperscriptBox["qy", "2"], "+", 
        SuperscriptBox["qz", "2"]}]], "-", 
      FractionBox[
       RowBox[{"qz", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pw", " ", "qw"}], "-", 
          RowBox[{"px", " ", "qx"}], "-", 
          RowBox[{"py", " ", "qy"}], "-", 
          RowBox[{"pz", " ", "qz"}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["qw", "2"], "+", 
        SuperscriptBox["qx", "2"], "+", 
        SuperscriptBox["qy", "2"], "+", 
        SuperscriptBox["qz", "2"]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"qz", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"pz", " ", "qw"}], "+", 
         RowBox[{"py", " ", "qx"}], "-", 
         RowBox[{"px", " ", "qy"}], "+", 
         RowBox[{"pw", " ", "qz"}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox["qw", "2"], "+", 
       SuperscriptBox["qx", "2"], "+", 
       SuperscriptBox["qy", "2"], "+", 
       SuperscriptBox["qz", "2"]}]], "+", 
     FractionBox[
      RowBox[{"qy", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"py", " ", "qw"}], "-", 
         RowBox[{"pz", " ", "qx"}], "+", 
         RowBox[{"pw", " ", "qy"}], "+", 
         RowBox[{"px", " ", "qz"}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox["qw", "2"], "+", 
       SuperscriptBox["qx", "2"], "+", 
       SuperscriptBox["qy", "2"], "+", 
       SuperscriptBox["qz", "2"]}]], "+", 
     FractionBox[
      RowBox[{"qx", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"px", " ", "qw"}], "+", 
         RowBox[{"pw", " ", "qx"}], "+", 
         RowBox[{"pz", " ", "qy"}], "-", 
         RowBox[{"py", " ", "qz"}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox["qw", "2"], "+", 
       SuperscriptBox["qx", "2"], "+", 
       SuperscriptBox["qy", "2"], "+", 
       SuperscriptBox["qz", "2"]}]], "+", 
     FractionBox[
      RowBox[{"qw", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"pw", " ", "qw"}], "-", 
         RowBox[{"px", " ", "qx"}], "-", 
         RowBox[{"py", " ", "qy"}], "-", 
         RowBox[{"pz", " ", "qz"}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox["qw", "2"], "+", 
       SuperscriptBox["qx", "2"], "+", 
       SuperscriptBox["qy", "2"], "+", 
       SuperscriptBox["qz", "2"]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8962469767221093`*^9, 3.896247684407571*^9, 
  3.896248111563161*^9, 3.896248161255397*^9, 3.896248197914689*^9, 
  3.8962483194898353`*^9, 3.8962483717273207`*^9, 3.8962486740903273`*^9, 
  3.8963136388058624`*^9},
 CellLabel->
  "Out[126]=",ExpressionUUID->"33e42fc7-eb50-4064-bb47-ed302523a9d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pOrigin", " ", "=", " ", 
    RowBox[{"Flatten", "[", "p", "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{"pTrans", " ", "=", "  ", 
  RowBox[{"Flatten", "[", "f", "]"}]}]}], "Input",
 CellChangeTimes->{{3.896247046358805*^9, 3.8962471134259005`*^9}, {
   3.896247595375638*^9, 3.896247653078824*^9}, 3.896247689767336*^9, 
   3.89624838055892*^9, {3.89624864288685*^9, 3.8962486528217306`*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"3cb99798-a53c-45d9-b37a-20c564ee61e1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"pz", " ", "qw", " ", "qy"}], "+", 
        RowBox[{"py", " ", "qx", " ", "qy"}], "-", 
        RowBox[{"px", " ", 
         SuperscriptBox["qy", "2"]}], "-", 
        RowBox[{"py", " ", "qw", " ", "qz"}], "+", 
        RowBox[{"pz", " ", "qx", " ", "qz"}], "-", 
        RowBox[{"px", " ", 
         SuperscriptBox["qz", "2"]}], "+", 
        RowBox[{"qw", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"px", " ", "qw"}], "+", 
           RowBox[{"pw", " ", "qx"}], "+", 
           RowBox[{"pz", " ", "qy"}], "-", 
           RowBox[{"py", " ", "qz"}]}], ")"}]}], "-", 
        RowBox[{"qx", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pw", " ", "qw"}], "-", 
           RowBox[{"px", " ", "qx"}], "-", 
           RowBox[{"py", " ", "qy"}], "-", 
           RowBox[{"pz", " ", "qz"}]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", "pz"}], " ", "qw", " ", "qx"}], "-", 
        RowBox[{"py", " ", 
         SuperscriptBox["qx", "2"]}], "+", 
        RowBox[{"px", " ", "qx", " ", "qy"}], "+", 
        RowBox[{"px", " ", "qw", " ", "qz"}], "+", 
        RowBox[{"pz", " ", "qy", " ", "qz"}], "-", 
        RowBox[{"py", " ", 
         SuperscriptBox["qz", "2"]}], "+", 
        RowBox[{"qw", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"py", " ", "qw"}], "-", 
           RowBox[{"pz", " ", "qx"}], "+", 
           RowBox[{"pw", " ", "qy"}], "+", 
           RowBox[{"px", " ", "qz"}]}], ")"}]}], "-", 
        RowBox[{"qy", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pw", " ", "qw"}], "-", 
           RowBox[{"px", " ", "qx"}], "-", 
           RowBox[{"py", " ", "qy"}], "-", 
           RowBox[{"pz", " ", "qz"}]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{"py", " ", "qw", " ", "qx"}], "-", 
        RowBox[{"pz", " ", 
         SuperscriptBox["qx", "2"]}], "-", 
        RowBox[{"px", " ", "qw", " ", "qy"}], "-", 
        RowBox[{"pz", " ", 
         SuperscriptBox["qy", "2"]}], "+", 
        RowBox[{"px", " ", "qx", " ", "qz"}], "+", 
        RowBox[{"py", " ", "qy", " ", "qz"}], "+", 
        RowBox[{"qw", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pz", " ", "qw"}], "+", 
           RowBox[{"py", " ", "qx"}], "-", 
           RowBox[{"px", " ", "qy"}], "+", 
           RowBox[{"pw", " ", "qz"}]}], ")"}]}], "-", 
        RowBox[{"qz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pw", " ", "qw"}], "-", 
           RowBox[{"px", " ", "qx"}], "-", 
           RowBox[{"py", " ", "qy"}], "-", 
           RowBox[{"pz", " ", "qz"}]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{"qz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pz", " ", "qw"}], "+", 
           RowBox[{"py", " ", "qx"}], "-", 
           RowBox[{"px", " ", "qy"}], "+", 
           RowBox[{"pw", " ", "qz"}]}], ")"}]}], "+", 
        RowBox[{"qy", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"py", " ", "qw"}], "-", 
           RowBox[{"pz", " ", "qx"}], "+", 
           RowBox[{"pw", " ", "qy"}], "+", 
           RowBox[{"px", " ", "qz"}]}], ")"}]}], "+", 
        RowBox[{"qx", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"px", " ", "qw"}], "+", 
           RowBox[{"pw", " ", "qx"}], "+", 
           RowBox[{"pz", " ", "qy"}], "-", 
           RowBox[{"py", " ", "qz"}]}], ")"}]}], "+", 
        RowBox[{"qw", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pw", " ", "qw"}], "-", 
           RowBox[{"px", " ", "qx"}], "-", 
           RowBox[{"py", " ", "qy"}], "-", 
           RowBox[{"pz", " ", "qz"}]}], ")"}]}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8963138510034423`*^9, 3.8963138572119446`*^9}},
 CellLabel->
  "Out[146]//MatrixForm=",ExpressionUUID->"750eb85a-4cab-4162-8fb0-\
b3f544b4f992"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ax", " ", "=", " ", 
  RowBox[{"pTrans", " ", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"px", " ", "\[Rule]", " ", "1"}], ",", " ", 
     RowBox[{"py", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"pz", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"pw", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox["qw", "2"], "+", 
       SuperscriptBox["qx", "2"], "+", 
       SuperscriptBox["qy", "2"], "+", 
       SuperscriptBox["qz", "2"]}], " ", "\[Rule]", " ", "1"}]}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.8962473210826645`*^9, 3.896247392591467*^9}, 
   3.8962477123449574`*^9, {3.896247755230053*^9, 3.8962477741605124`*^9}, {
   3.8962478611357775`*^9, 3.8962479511095533`*^9}, {3.896248275334612*^9, 
   3.896248280686895*^9}, 3.896248655535324*^9, {3.8962488098060827`*^9, 
   3.8962488152062054`*^9}, {3.8963136443119698`*^9, 3.896313659801363*^9}, {
   3.8963141572714906`*^9, 3.896314159512908*^9}, 3.896314772638711*^9},
 CellLabel->
  "In[183]:=",ExpressionUUID->"d06aee18-c3e2-4048-ba83-f90311bb0ef9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["qw", "2"], "+", 
    SuperscriptBox["qx", "2"], "-", 
    SuperscriptBox["qy", "2"], "-", 
    SuperscriptBox["qz", "2"]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "qx", " ", "qy"}], "+", 
    RowBox[{"2", " ", "qw", " ", "qz"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", "qw", " ", "qy"}], "+", 
    RowBox[{"2", " ", "qx", " ", "qz"}]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.896314159826909*^9, 3.896314774399556*^9},
 CellLabel->
  "Out[183]=",ExpressionUUID->"7cf5faf3-a0dd-47b2-a17b-730ebf5d3c65"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ay", " ", "=", " ", 
  RowBox[{"pTrans", " ", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"px", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"py", " ", "\[Rule]", " ", "1"}], ",", " ", 
     RowBox[{"pz", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"pw", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox["qw", "2"], "+", 
       SuperscriptBox["qx", "2"], "+", 
       SuperscriptBox["qy", "2"], "+", 
       SuperscriptBox["qz", "2"]}], " ", "\[Rule]", " ", "1"}]}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.896247959959589*^9, 3.896247967078264*^9}, {
   3.8962482824716425`*^9, 3.896248288142001*^9}, 3.896248657638962*^9, 
   3.8962488231910243`*^9, {3.8963141627600737`*^9, 3.896314167912779*^9}, 
   3.8963147704721584`*^9},
 CellLabel->
  "In[184]:=",ExpressionUUID->"57593f1d-d076-4867-9cc6-b8872f3052c2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"2", " ", "qx", " ", "qy"}], "-", 
    RowBox[{"2", " ", "qw", " ", "qz"}]}], ",", 
   RowBox[{
    SuperscriptBox["qw", "2"], "-", 
    SuperscriptBox["qx", "2"], "+", 
    SuperscriptBox["qy", "2"], "-", 
    SuperscriptBox["qz", "2"]}], ",", 
   RowBox[{
    RowBox[{"2", " ", "qw", " ", "qx"}], "+", 
    RowBox[{"2", " ", "qy", " ", "qz"}]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.8963141682422037`*^9, 3.8963147752612*^9},
 CellLabel->
  "Out[184]=",ExpressionUUID->"e79e3439-cce6-49bc-8a09-3c8a1e05808b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Az", " ", "=", " ", 
  RowBox[{"pTrans", " ", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"px", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"py", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"pz", " ", "\[Rule]", " ", "1"}], ",", " ", 
     RowBox[{"pw", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox["qw", "2"], "+", 
       SuperscriptBox["qx", "2"], "+", 
       SuperscriptBox["qy", "2"], "+", 
       SuperscriptBox["qz", "2"]}], " ", "\[Rule]", " ", "1"}]}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.896247975078918*^9, 3.896247980087487*^9}, {
   3.8962482906307383`*^9, 3.8962482951507607`*^9}, 3.896248660294196*^9, 
   3.8962488243275213`*^9, {3.89631417109595*^9, 3.8963141743155174`*^9}, 
   3.896314768470721*^9},
 CellLabel->
  "In[185]:=",ExpressionUUID->"8be384f4-7086-42d5-8219-cdd846ffaf18"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"2", " ", "qw", " ", "qy"}], "+", 
    RowBox[{"2", " ", "qx", " ", "qz"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", "qw", " ", "qx"}], "+", 
    RowBox[{"2", " ", "qy", " ", "qz"}]}], ",", 
   RowBox[{
    SuperscriptBox["qw", "2"], "-", 
    SuperscriptBox["qx", "2"], "-", 
    SuperscriptBox["qy", "2"], "+", 
    SuperscriptBox["qz", "2"]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.8963141746908016`*^9, 3.8963147762379236`*^9},
 CellLabel->
  "Out[185]=",ExpressionUUID->"8838acbb-092a-4e8d-b92f-87502e756838"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Aw", " ", "=", " ", 
  RowBox[{
   RowBox[{"pTrans", " ", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"px", " ", "\[Rule]", " ", "0"}], ",", " ", 
      RowBox[{"py", " ", "\[Rule]", " ", "0"}], ",", " ", 
      RowBox[{"pz", " ", "\[Rule]", " ", "0"}], ",", " ", 
      RowBox[{"pw", " ", "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{
       RowBox[{
        SuperscriptBox["qw", "2"], "+", 
        SuperscriptBox["qx", "2"], "+", 
        SuperscriptBox["qy", "2"], "+", 
        SuperscriptBox["qz", "2"]}], " ", "\[Rule]", " ", "1"}]}], "}"}]}], 
   " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["qw", "2"], "+", 
      SuperscriptBox["qx", "2"], "+", 
      SuperscriptBox["qy", "2"], "+", 
      SuperscriptBox["qz", "2"]}], " ", "\[Rule]", " ", "1"}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.896247988834854*^9, 3.89624799399821*^9}, {
   3.8962480370855503`*^9, 3.8962480643899612`*^9}, {3.896248297270608*^9, 
   3.896248302846192*^9}, 3.8962486625745277`*^9, {3.8962488252702045`*^9, 
   3.8962488936779795`*^9}, {3.896314177975899*^9, 3.896314179249567*^9}, 
   3.8963147660315046`*^9},
 CellLabel->
  "In[186]:=",ExpressionUUID->"cefaeeee-39e8-4baa-91df-cd7730660ca3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.896314180547635*^9, 3.896314777358156*^9},
 CellLabel->
  "Out[186]=",ExpressionUUID->"6fb4d9e1-6481-4faf-aaaa-2fbeff7ce344"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"S", " ", "=", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"ArrayFlatten", "[", 
     RowBox[{"{", 
      RowBox[{"Ax", ",", " ", "Ay", ",", " ", "Az", ",", " ", "Aw"}], "}"}], 
     "]"}], "]"}], "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.896248500914611*^9, 3.896248633820856*^9}, {
  3.896248704023555*^9, 3.896248804574097*^9}, {3.896314186951027*^9, 
  3.8963142223119063`*^9}, {3.896314284897709*^9, 3.896314378526351*^9}, {
  3.8963144289425554`*^9, 3.896314474231518*^9}, {3.896314582270084*^9, 
  3.8963146296559844`*^9}, {3.8963147025419836`*^9, 3.8963147512723184`*^9}, {
  3.896314787753208*^9, 3.8963148204394655`*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"ad8fbb8c-bea6-4c73-a6b2-6697d5e2d2ba"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SuperscriptBox["qw", "2"], "+", 
       SuperscriptBox["qx", "2"], "-", 
       SuperscriptBox["qy", "2"], "-", 
       SuperscriptBox["qz", "2"]}], 
      RowBox[{
       RowBox[{"2", " ", "qx", " ", "qy"}], "-", 
       RowBox[{"2", " ", "qw", " ", "qz"}]}], 
      RowBox[{
       RowBox[{"2", " ", "qw", " ", "qy"}], "+", 
       RowBox[{"2", " ", "qx", " ", "qz"}]}], "0"},
     {
      RowBox[{
       RowBox[{"2", " ", "qx", " ", "qy"}], "+", 
       RowBox[{"2", " ", "qw", " ", "qz"}]}], 
      RowBox[{
       SuperscriptBox["qw", "2"], "-", 
       SuperscriptBox["qx", "2"], "+", 
       SuperscriptBox["qy", "2"], "-", 
       SuperscriptBox["qz", "2"]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "qw", " ", "qx"}], "+", 
       RowBox[{"2", " ", "qy", " ", "qz"}]}], "0"},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "qw", " ", "qy"}], "+", 
       RowBox[{"2", " ", "qx", " ", "qz"}]}], 
      RowBox[{
       RowBox[{"2", " ", "qw", " ", "qx"}], "+", 
       RowBox[{"2", " ", "qy", " ", "qz"}]}], 
      RowBox[{
       SuperscriptBox["qw", "2"], "-", 
       SuperscriptBox["qx", "2"], "-", 
       SuperscriptBox["qy", "2"], "+", 
       SuperscriptBox["qz", "2"]}], "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.896248541193981*^9, 3.896248634197774*^9}, {
   3.8962486924418926`*^9, 3.896248719396349*^9}, {3.8962487664629574`*^9, 
   3.896248794375782*^9}, 3.896248837362438*^9, 3.896248896123285*^9, {
   3.8963137063035736`*^9, 3.8963137099464006`*^9}, {3.8963141876420574`*^9, 
   3.8963142032857437`*^9}, {3.8963142949015255`*^9, 3.896314379024929*^9}, {
   3.8963144294599347`*^9, 3.8963144694628572`*^9}, {3.8963145858415475`*^9, 
   3.896314629997179*^9}, {3.8963147058411207`*^9, 3.8963147902938786`*^9}, 
   3.896314821091466*^9},
 CellLabel->
  "Out[189]//MatrixForm=",ExpressionUUID->"2ea69576-06dc-4881-abba-\
d870a46692b6"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"QuaternionDot", "[", 
   RowBox[{"q_", ",", " ", "p_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"qv", ",", " ", "qw", ",", " ", "pv", ",", " ", "pw"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"qv", ",", " ", "qw"}], "}"}], " ", "=", " ", "q"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pv", ",", " ", "pw"}], "}"}], " ", "=", " ", "p"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Dot", "[", 
       RowBox[{"qv", ",", " ", "pv"}], "]"}], " ", "+", " ", 
      RowBox[{"qw", "  ", "pw"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"QuaternionMultiply", "[", 
    RowBox[{"q_", ",", " ", "p_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"qv", ",", " ", "qw", ",", " ", "pv", ",", " ", "pw"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"qv", ",", " ", "qw"}], "}"}], " ", "=", " ", "q"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pv", ",", " ", "pw"}], "}"}], " ", "=", " ", "p"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Cross", "[", 
          RowBox[{"qv", ",", " ", "pv"}], "]"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"pw", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "  ", "qv"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"qw", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "pv"}]}], ",", " ", 
        RowBox[{
         RowBox[{"qw", " ", "pw"}], " ", "-", " ", 
         RowBox[{"Dot", "[", 
          RowBox[{"qv", ",", " ", "pv"}], "]"}]}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"QuaternionInverse", "[", "q_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"qv", ",", " ", "qw"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"qv", ",", " ", "qw"}], "}"}], " ", "=", " ", "q"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "qv"}], " ", ",", " ", "qw"}], "}"}], "/", 
       RowBox[{
        RowBox[{"QuaternionDot", "[", 
         RowBox[{"q", ",", " ", "q"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QuaternionToMatrix", "[", "q_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "px", ",", " ", "py", ",", " ", "pz", ",", " ", "pw", ",", " ", "p"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"p", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"px", ",", " ", "py", ",", " ", "pz"}], "}"}], ",", " ", 
        RowBox[{"{", "pw", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"p", " ", "=", 
      RowBox[{"QuaternionMultiply", "[", 
       RowBox[{
        RowBox[{"QuaternionMultiply", "[", 
         RowBox[{"q", ",", "p"}], "]"}], ",", " ", 
        RowBox[{"QuaternionInverse", "[", "q", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"p", " ", "=", " ", 
      RowBox[{"Flatten", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Transpose", "[", 
      RowBox[{"ArrayFlatten", "[", 
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{"p", " ", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"px", " ", "\[Rule]", " ", "1"}], ",", " ", 
            RowBox[{"py", " ", "\[Rule]", " ", "0"}], ",", " ", 
            RowBox[{"pz", " ", "\[Rule]", " ", "0"}], ",", " ", 
            RowBox[{"pw", " ", "\[Rule]", " ", "0"}]}], "}"}]}], ",", " ", 
         RowBox[{"p", " ", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"px", " ", "\[Rule]", " ", "0"}], ",", " ", 
            RowBox[{"py", " ", "\[Rule]", " ", "1"}], ",", " ", 
            RowBox[{"pz", " ", "\[Rule]", " ", "0"}], ",", " ", 
            RowBox[{"pw", " ", "\[Rule]", " ", "0"}]}], "}"}]}], ",", "  ", 
         RowBox[{"p", " ", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"px", " ", "\[Rule]", " ", "0"}], ",", " ", 
            RowBox[{"py", " ", "\[Rule]", " ", "0"}], ",", " ", 
            RowBox[{"pz", " ", "\[Rule]", " ", "1"}], ",", " ", 
            RowBox[{"pw", " ", "\[Rule]", " ", "0"}]}], "}"}]}], ",", "  ", 
         RowBox[{"p", " ", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"px", " ", "\[Rule]", " ", "0"}], ",", " ", 
            RowBox[{"py", " ", "\[Rule]", " ", "0"}], ",", " ", 
            RowBox[{"pz", " ", "\[Rule]", " ", "0"}], ",", " ", 
            RowBox[{"pw", " ", "\[Rule]", " ", "1"}]}], "}"}]}]}], "}"}], 
       "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QuaternionSlerp", "[", 
   RowBox[{"t_", ",", "q_", ",", " ", "p_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "theta", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"theta", " ", "=", " ", 
      RowBox[{"ArcCos", "[", 
       RowBox[{
        RowBox[{"QuaternionDot", "[", 
         RowBox[{"q", ",", " ", "p"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"q", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", " ", "-", " ", "t"}], ")"}], "theta"}], "]"}]}], " ",
         "+", " ", 
        RowBox[{"p", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"t", " ", "theta"}], "]"}]}]}], ")"}], " ", "/", " ", 
      RowBox[{"Sin", "[", "theta", "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8963103021431913`*^9, 3.8963103145669365`*^9}, {
   3.8963105675532894`*^9, 3.89631064843885*^9}, {3.896310692143386*^9, 
   3.8963107025584917`*^9}, {3.8963107426469793`*^9, 
   3.8963110335522237`*^9}, {3.896313282881203*^9, 3.896313333872664*^9}, {
   3.8963133756498737`*^9, 3.8963133797039757`*^9}, {3.896314852688501*^9, 
   3.896314916903658*^9}, {3.896314963425779*^9, 3.8963149712086725`*^9}, {
   3.896315005048294*^9, 3.896315012662908*^9}, {3.896315055182497*^9, 
   3.8963150938804164`*^9}, 3.8963151453700476`*^9, {3.8963151944169426`*^9, 
   3.896315243952887*^9}, {3.8963152982899275`*^9, 3.8963155602330894`*^9}, {
   3.8963156358187423`*^9, 3.896315640313822*^9}, {3.8963157496916585`*^9, 
   3.896315754120982*^9}},
 CellLabel->
  "In[303]:=",ExpressionUUID->"95a785fd-e185-460e-8d6c-5672c1238940"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"q", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"qx", ",", " ", "qy", ",", " ", "qz"}], "}"}], ",", " ", 
     RowBox[{"{", "qw", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"px", ",", " ", "py", ",", " ", "pz"}], "}"}], ",", " ", 
     RowBox[{"{", "pw", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qP", " ", "=", " ", 
   RowBox[{"QuaternionInverse", "[", "q", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QuaternionMultiply", "[", 
   RowBox[{
    RowBox[{"QuaternionMultiply", "[", 
     RowBox[{"q", ",", "p"}], "]"}], ",", " ", "qP"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"QuaternionToMatrix", "[", "q", "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["qw", "2"], "+", 
       SuperscriptBox["qx", "2"], "+", 
       SuperscriptBox["qy", "2"], "+", 
       SuperscriptBox["qz", "2"]}], " ", "\[Rule]", " ", "1"}], "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["qw", "2"], "+", 
      SuperscriptBox["qx", "2"], "+", 
      SuperscriptBox["qy", "2"], "+", 
      SuperscriptBox["qz", "2"]}], " ", "\[Rule]", " ", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"R", " ", "=", " ", 
  RowBox[{
   RowBox[{"QuaternionToMatrix", "[", 
    RowBox[{"QuaternionSlerp", "[", 
     RowBox[{"t", ",", " ", "q", ",", " ", "p"}], "]"}], "]"}], "//", 
   "MatrixForm"}]}], "\[IndentingNewLine]", 
 RowBox[{"T", " ", "=", " "}]}], "Input",
 CellChangeTimes->{{3.896310327563492*^9, 3.8963103278781667`*^9}, {
   3.896310380727028*^9, 3.8963105410948334`*^9}, {3.896311040112121*^9, 
   3.8963110422630777`*^9}, {3.8963132605208883`*^9, 
   3.8963132844887853`*^9}, {3.8963134730811577`*^9, 3.8963135123679295`*^9}, 
   3.8963151374078965`*^9, {3.896315568864137*^9, 3.896315588790722*^9}, {
   3.8963156628649187`*^9, 3.8963156890901804`*^9}, {3.8963160997260957`*^9, 
   3.8963161237269545`*^9}},ExpressionUUID->"2b8db151-6663-43a6-84d8-\
a5a94257e72d"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         TagBox[
          RowBox[{"(", "\[NoBreak]", 
           TemplateBox[{"1"},
            "OutputSizeLimit`Skeleton"], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          PaneBox[
           TagBox[
            TooltipBox[
             StyleBox[
              StyleBox[
               DynamicBox[ToBoxes[
                 FEPrivate`FrontEndResource[
                 "FEStrings", "sizeBriefExplanation"], StandardForm],
                ImageSizeCache->{96., {4., 20.}}],
               StripOnInput->False,
               DynamicUpdating->True,
               LineSpacing->{1, 2},
               LineIndent->0,
               LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLText",
              StripOnInput->False],
             StyleBox[
              DynamicBox[
               ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
                StandardForm]], DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}, StripOnInput -> False]],
            Annotation[#, 
             Style[
              Dynamic[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
              DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}], "Tooltip"]& ],
           Alignment->Center,
           BaselinePosition->Baseline,
           ImageSize->{Automatic, {25, Full}}], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{96., {4., 20.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
             Composition[OutputSizeLimit`Defer, 
              Function[{OutputSizeLimit`Dump`x$}, 
               MatrixForm[OutputSizeLimit`Dump`x$]]], 319, 
             16843497456069350478, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{96., {4., 20.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
             Composition[OutputSizeLimit`Defer, 
              Function[{OutputSizeLimit`Dump`x$}, 
               MatrixForm[OutputSizeLimit`Dump`x$]]], 319, 
             16843497456069350478, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{96., {4., 20.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
             Composition[OutputSizeLimit`Defer, 
              Function[{OutputSizeLimit`Dump`x$}, 
               MatrixForm[OutputSizeLimit`Dump`x$]]], 319, 
             16843497456069350478, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{165., {4., 20.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[16843497456069350478 === $SessionID, 
   Out[319], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellChangeTimes->{{3.896310455270074*^9, 3.8963105424071903`*^9}, 
   3.8963110431090508`*^9, 3.8963132276313295`*^9, {3.8963132645420523`*^9, 
   3.8963132856545453`*^9}, 3.8963133243025017`*^9, 3.896313382051305*^9, {
   3.8963134734992933`*^9, 3.8963135064451303`*^9}, 3.89631488808407*^9, 
   3.8963149202428513`*^9, 3.896314973853159*^9, {3.896315068650235*^9, 
   3.89631509566236*^9}, {3.8963151380232067`*^9, 3.8963151467131586`*^9}, {
   3.8963155316023045`*^9, 3.8963155477791896`*^9}, 3.896315591042466*^9, {
   3.8963156440437946`*^9, 3.896315689538265*^9}, 3.8963157562428493`*^9, 
   3.896316118013468*^9},
 CellLabel->
  "Out[319]//MatrixForm=",ExpressionUUID->"f0fad928-1c86-499f-8ccb-\
92b1348d5469"]
}, Open  ]]
},
WindowSize->{1130, 848},
WindowMargins->{{376, Automatic}, {Automatic, 55}},
Magnification:>2. Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (2019\:5e744\:67088\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1519, 39, 204, "Input",ExpressionUUID->"500b4d60-3c61-493a-8add-e35571207041"],
Cell[2102, 63, 817, 25, 184, "Output",ExpressionUUID->"582ce7c3-0129-4f61-a9e2-c5b49489e218"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2956, 93, 320, 6, 87, "Input",ExpressionUUID->"9bde7ba8-935a-42d7-93cc-b8507fcff598"],
Cell[3279, 101, 1108, 33, 184, "Output",ExpressionUUID->"8f8dc3e6-c23b-453f-9da7-83f844b6465d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4424, 139, 238, 4, 87, "Input",ExpressionUUID->"3af15df1-59ac-4b71-bb66-e1f450f3ec4d"],
Cell[4665, 145, 4984, 134, 229, "Output",ExpressionUUID->"b6ea8598-8494-4b40-bc37-1df0739e51a4"]
}, Open  ]],
Cell[9664, 282, 169, 3, 62, "Item",ExpressionUUID->"a171dad5-5b52-4fb0-aff9-56ed50bfb95f"],
Cell[9836, 287, 637, 15, 97, "Input",ExpressionUUID->"9eb72d7a-445e-495f-9e08-fa10cea388e9"],
Cell[10476, 304, 379, 8, 87, "Input",ExpressionUUID->"4ffd4c0f-1428-4124-95d8-3454b2df4212"],
Cell[10858, 314, 286, 6, 57, "Input",ExpressionUUID->"96cb7322-7544-4bb3-ad58-73e0c8b7c7ab"],
Cell[CellGroupData[{
Cell[11169, 324, 343, 6, 87, "Input",ExpressionUUID->"3187cc61-e354-41c6-a8bd-ef2077b6f6ff"],
Cell[11515, 332, 459, 14, 65, "Output",ExpressionUUID->"40ed33fa-06f9-491d-879d-a8094f746a0e"]
}, Open  ]],
Cell[11989, 349, 629, 14, 87, "Input",ExpressionUUID->"f5ab1201-ae2a-45f5-badc-23f86f96ef1a"],
Cell[12621, 365, 810, 20, 159, "Input",ExpressionUUID->"3179ea4c-9bb3-4dfb-adf9-5c6df0afe4b0"],
Cell[13434, 387, 710, 18, 159, "Input",ExpressionUUID->"c1cf67bf-211a-47ac-a3eb-b53f46859a92"],
Cell[14147, 407, 778, 19, 159, "Input",ExpressionUUID->"005be437-3579-4650-8ddd-a25fb451cf21"],
Cell[CellGroupData[{
Cell[14950, 430, 1269, 22, 87, "Input",ExpressionUUID->"6e395f7f-a1aa-4e8f-b3bc-13ddd4c0a46f"],
Cell[16222, 454, 2287, 66, 184, "Output",ExpressionUUID->"42910cfe-194e-4385-a741-d45590df5a5d"]
}, Open  ]],
Cell[18524, 523, 667, 11, 142, "Item",ExpressionUUID->"2190c82c-85e2-4d56-b643-98981319ee91"],
Cell[19194, 536, 310, 7, 174, "Code",ExpressionUUID->"b635e2f6-ebc6-4e8d-b6b0-f8e81c9dc52b",
 InitializationCell->False],
Cell[19507, 545, 149, 3, 97, "Input",ExpressionUUID->"3c756986-6164-4927-a5fa-9470b3b10776"],
Cell[19659, 550, 526, 8, 62, "Item",ExpressionUUID->"fcea923a-c8c1-4d66-b5d4-607843cdb9ff"],
Cell[20188, 560, 776, 19, 97, "Input",ExpressionUUID->"a940db92-8077-4575-947c-ef760282914e"],
Cell[20967, 581, 1636, 44, 184, "Input",ExpressionUUID->"825ffb8d-f1ba-4ef2-b29f-845f5ae84f68"],
Cell[CellGroupData[{
Cell[22628, 629, 1694, 54, 262, "Input",ExpressionUUID->"f1442002-246a-4fa0-9ec6-d30b0158a241"],
Cell[24325, 685, 499, 14, 90, "Output",ExpressionUUID->"61010af5-6b97-4786-9721-fc0792977f4e"],
Cell[24827, 701, 589, 16, 95, "Output",ExpressionUUID->"6cb23ba7-c339-4fb3-aa62-984d19f3de98"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25453, 722, 1731, 50, 262, "Input",ExpressionUUID->"a795cf5f-5c09-48f1-9598-f0acee7276f5"],
Cell[27187, 774, 9524, 278, 872, "Output",ExpressionUUID->"33e42fc7-eb50-4064-bb47-ed302523a9d7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36748, 1057, 535, 11, 184, "Input",ExpressionUUID->"3cb99798-a53c-45d9-b37a-20c564ee61e1"],
Cell[37286, 1070, 4398, 122, 195, "Output",ExpressionUUID->"750eb85a-4cab-4162-8fb0-b3f544b4f992"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41721, 1197, 1108, 23, 131, "Input",ExpressionUUID->"d06aee18-c3e2-4048-ba83-f90311bb0ef9"],
Cell[42832, 1222, 609, 17, 95, "Output",ExpressionUUID->"7cf5faf3-a0dd-47b2-a17b-730ebf5d3c65"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43478, 1244, 906, 21, 131, "Input",ExpressionUUID->"57593f1d-d076-4867-9cc6-b8872f3052c2"],
Cell[44387, 1267, 588, 16, 95, "Output",ExpressionUUID->"e79e3439-cce6-49bc-8a09-3c8a1e05808b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45012, 1288, 905, 21, 131, "Input",ExpressionUUID->"8be384f4-7086-42d5-8219-cdd846ffaf18"],
Cell[45920, 1311, 613, 17, 95, "Output",ExpressionUUID->"8838acbb-092a-4e8d-b92f-87502e756838"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46570, 1333, 1261, 31, 171, "Input",ExpressionUUID->"cefaeeee-39e8-4baa-91df-cd7730660ca3"],
Cell[47834, 1366, 240, 5, 90, "Output",ExpressionUUID->"6fb4d9e1-6481-4faf-aaaa-2fbeff7ce344"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48111, 1376, 761, 15, 112, "Input",ExpressionUUID->"ad8fbb8c-bea6-4c73-a6b2-6697d5e2d2ba"],
Cell[48875, 1393, 2396, 63, 195, "Output",ExpressionUUID->"2ea69576-06dc-4881-abba-d870a46692b6"]
}, Open  ]],
Cell[51286, 1459, 7029, 176, 1649, "Input",ExpressionUUID->"95a785fd-e185-460e-8d6c-5672c1238940"],
Cell[CellGroupData[{
Cell[58340, 1639, 2202, 58, 375, "Input",ExpressionUUID->"2b8db151-6663-43a6-84d8-a5a94257e72d"],
Cell[60545, 1699, 9805, 246, 181, "Output",ExpressionUUID->"f0fad928-1c86-499f-8ccb-92b1348d5469"]
}, Open  ]]
}
]
*)

